<div class="result-page">
    @if (isLoading()) {
    <div class="loading-container">
        <div class="loading-spinner">
            <span class="material-symbols-outlined rotating">autorenew</span>
        </div>
        <p>ƒêang ph√¢n t√≠ch l√° s·ªë c·ªßa b·∫°n...</p>
    </div>
    } @else {
    <div class="container">
        <!-- Profile Card -->
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-avatar">
                    <span class="avatar-glyph">{{ formData()?.fullName?.charAt(0) || 'T' }}</span>
                </div>
                <div class="profile-info">
                    <h1 class="profile-name">{{ formData()?.fullName }}</h1>
                    <div class="profile-dates">
                        <span class="date-item">
                            <span class="material-symbols-outlined">calendar_today</span>
                            D∆∞∆°ng l·ªãch: {{ formData()?.birthDate }}
                        </span>
                        <span class="date-item lunar">
                            <span class="material-symbols-outlined">dark_mode</span>
                            √Çm l·ªãch: (S·∫Ω ƒë∆∞·ª£c t√≠nh to√°n)
                        </span>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="action-btn" (click)="printResult()">
                        <span class="material-symbols-outlined">print</span>
                        In
                    </button>
                    <button class="action-btn" (click)="shareResult()">
                        <span class="material-symbols-outlined">share</span>
                        Chia s·∫ª
                    </button>
                </div>
            </div>
            <div class="profile-quote">
                <span class="quote-icon">"</span>
                <p>ƒê·ª©c nƒÉng th·∫Øng s·ªë, nh√¢n ƒë·ªãnh th·∫Øng thi√™n</p>
            </div>
        </div>

        <!-- Result Grid -->
        <div class="result-grid">
            <div class="result-column">
                <!-- Fortune Card -->
                <div class="insight-card fortune-card">
                    <div class="card-header">
                        <h2>
                            <span class="material-symbols-outlined">stars</span>
                            V·∫≠n M·ªánh T·ªïng Quan
                        </h2>
                        <span class="card-badge good">T·ªët</span>
                    </div>
                    <div class="fortune-meter">
                        <div class="meter-track">
                            <div class="meter-fill" [style.width.%]="fortuneLevel()"></div>
                        </div>
                        <div class="meter-labels">
                            <span>X·∫•u</span>
                            <span>Trung b√¨nh</span>
                            <span>T·ªët</span>
                        </div>
                    </div>
                    <div class="fortune-stats">
                        <div class="stat-item">
                            <span class="stat-label">C√¥ng danh</span>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 85%"></div>
                            </div>
                            <span class="stat-value">85%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">T√¨nh duy√™n</span>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 72%"></div>
                            </div>
                            <span class="stat-value">72%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">T√†i l·ªôc</span>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 68%"></div>
                            </div>
                            <span class="stat-value">68%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">S·ª©c kh·ªèe</span>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 90%"></div>
                            </div>
                            <span class="stat-value">90%</span>
                        </div>
                    </div>
                </div>

                <!-- Interpretation Card -->
                <div class="insight-card">
                    <div class="card-header">
                        <h2>
                            <span class="material-symbols-outlined">auto_stories</span>
                            Gi·∫£i ƒêo√°n Chi Ti·∫øt
                        </h2>
                    </div>
                    <div class="interpretation-content">
                        <div class="interpretation-section">
                            <h3>
                                <span class="section-icon">üèõÔ∏è</span>
                                M·ªánh Cung
                            </h3>
                            <p>
                                M·ªánh cung c·ªßa b·∫°n c√≥ <strong>T·ª≠ Vi</strong> t·ªça th·ªß, ƒë√¢y l√† c√°ch t·ªët nh·∫•t trong T·ª≠ Vi
                                ƒê·∫©u S·ªë.
                                Ng∆∞·ªùi c√≥ m·ªánh n√†y th∆∞·ªùng c√≥ t∆∞ c√°ch l√£nh ƒë·∫°o, ƒë∆∞·ª£c ng∆∞·ªùi kh√°c t√¥n tr·ªçng.
                            </p>
                        </div>
                        <div class="interpretation-section">
                            <h3>
                                <span class="section-icon">üíº</span>
                                S·ª± Nghi·ªáp
                            </h3>
                            <p>
                                Quan l·ªôc cung c√≥ <strong>Thi√™n Ph·ªß</strong> chi·∫øu, cho th·∫•y s·ª± nghi·ªáp v·ªØng v√†ng,
                                c√≥ th·ªÉ ph√°t tri·ªÉn trong c√°c lƒ©nh v·ª±c qu·∫£n l√Ω, t√†i ch√≠nh ho·∫∑c kinh doanh.
                            </p>
                        </div>
                        <div class="interpretation-section">
                            <h3>
                                <span class="section-icon">‚ù§Ô∏è</span>
                                T√¨nh Duy√™n
                            </h3>
                            <p>
                                Phu th√™ cung c√≥ <strong>Th√°i √Çm</strong> t·ªça th·ªß, t√¨nh duy√™n √™m ƒë·ªÅm,
                                ph√π h·ª£p v·ªõi ng∆∞·ªùi c√≥ t√≠nh c√°ch ƒëi·ªÅm tƒ©nh, hi·ªÅn l√†nh.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="result-column">
                <!-- Chart Card (Placeholder) -->
                <div class="insight-card chart-card">
                    <div class="card-header">
                        <h2>
                            <span class="material-symbols-outlined">grid_view</span>
                            L√° S·ªë T·ª≠ Vi
                        </h2>
                    </div>
                    <div class="chart-placeholder">
                        <div class="placeholder-grid">
                            @for (i of [1,2,3,4,5,6,7,8,9,10,11,12]; track i) {
                            <div class="palace-cell">
                                <span class="palace-name">Cung {{ i }}</span>
                            </div>
                            }
                        </div>
                        <p class="placeholder-note">
                            <span class="material-symbols-outlined">info</span>
                            L√° s·ªë chi ti·∫øt s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi k·∫øt n·ªëi v·ªõi backend
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Back Button -->
        <div class="back-section">
            <button class="back-btn" (click)="goBack()">
                <span class="material-symbols-outlined">arrow_back</span>
                L·∫≠p l√° s·ªë m·ªõi
            </button>
        </div>
    </div>
    }
</div>